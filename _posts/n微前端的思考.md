---
layout: post
title:  微前端的思考
subtitle: 微前端的思考
date: 2020-09-28
author: Qi
header-img: img/404-bg.jpg
catalog: true
tags:
  - 微前端
---

# 什么是微前端

所谓的微前端就是将微服务理念应用于前端技术后的相关实践，使得一个项目拆分成多个小应用，小应用经由多个团队独立开发和部署，然后在主体应用中集成。

# 为什么要选择微前端

一个项目在刚成立时，体量很小，但随着项目不断做大，可能会出现以下问题：巨石应用、分支混乱、代码冲突、打包麻烦、维护困难对于这些问题，很难找到一个完美的解决方案，于是就诞生了微前端。

有了微前端后，我们能将一个大项目拆分成一个小项目，这样一来，每一个小项目就非常好优化了，在小项目优化完毕后再组成一个大应用

![Image text](/img/微前端.png)
在实际项目中，如果遇到以下问题，可以考虑使用微前端：
- 项目太大，形成了巨石应用，编译太慢
- 项目开发者太多，多个同学同事开发导致代码冲突
- 项目太老，存在遗留模块，需要渐进式更新
- 项目技术栈不统一，使用了不同的框架
- 项目由多个团队开发，一个功能需要等其他团队开发好之后，才能接着开发。
- 项目每次发布都是全量式更新，及时上线的是一个小模块
- 项目开发人员流动大，存在一些祖传代码难以维护，一般人都不好改
- 项目需要一些试验田方案，即需要在某些模块做一些新技术尝试、框架升级等。

# 微前端的特点

- 各个团队可以自由选择技术栈、不受其他项目中团队的影响
- 各个交付产物可以独立使用，避免与其他交付产物融合
- 各个交付产物的样式不会污染其他组件
- 各个交付产物可以自由使用浏览器API，而非封装后的api
- 各个交付产物可以独立部署，不会相互影响

# 微前端的缺点

- 当前微前端框架在vue和react融合花费了较多时间。相当于把vue和react进行了二次封装。这意味着主体框架需要加载vue、react的资源。这样就会导致静态资源较大。降低性能
- 拆分的粒度越小，便意味着架构变得复杂、维护成本变高。
- 开发体验不太友好，开发时可能需要同时启动多个项目。
- 管理版本复杂、依赖复杂

# 微前端需要解决的问题

- 微应用的注册、异步加载和生命周期管理。向乾坤的声明周期管理需要将react或者vue进行适配。异步加载可以使用System.js
- 微应用之间、主从之间的消息机制。通讯可以通过eventBus、localStorage、postMessage（任何页面通讯）、BroadcastChannel(同源通讯)
- 路由的动态加载，可以采用类似awailix的加载。
- 微应用之间的安全隔离措施。比如利用webcomponent。css的样式隔离采用css module。乾坤如果没有react和vue的cssmodule就不能做到样式隔离。
- 微应用版本无关、框架无关。
- 微应用之间、主从之间的公共依赖库和util怎么管理。
- 微应用独立调试、和主应用的联调方式快速定位报错。
- 微应用的发布流程
- 微应用的打包优化
- 微应用专有云场景的出包方案
- 渐进式升级，用微应用平滑重构老项目

参考

- https://lmjben.github.io/blog/devops-microfrontend.html




